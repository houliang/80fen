@extends 'base.html'

@set current_nick = handler.current_nick


@block css
<link rel="stylesheet/less" href="{{ static_url('css/80.less') }}">
@endblock


@block js
<script>
    window.nickname = '{{ current_nick }}';
</script>
<script type="text/coffeescript"
        src="{{ static_url('js/80.coffee') }}"></script>
<script src="{{ static_url('libs/poker.min.js') }}"></script>
@endblock


@block content
<div class="row">
    <div class="col-md-2">
        {{ lipsum()[:400] }}
    </div>
    <div class="col-md-7">
        @set ready = [False]
        @for p, nick in pos.iteritems()
            @if nick == current_nick
                @if ready.append(True)
                @endif
            @endif
        @endfor

        @set ready = ready[-1]

        <div id="ready" class="panel panel-default">
            <div class="panel-heading">备战区</div>
            <div class="panel-body">

                @macro one(p)
                @set nickname = pos[p].current_nick
                @if nickname
                    <a data-pos="{{ p }}"
                        class="{{ p }} btn btn-default disabled" href="#!">
                        {{ nickname }}
                    </a>
                @else
                    @if ready
                        <a data-pos="{{ p }}"
                            class="{{ p }} btn disabled btn-primary"
                            href="#!">
                            稍等
                        </a>
                    @else
                        <a data-pos="{{ p }}"
                            class="{{ p }} btn btn-primary" href="#!">
                            坐下
                        </a>
                    @endif
                @endif
                @endmacro

                {{ one('n') }}<br>
                {{ one('w') }}
                {{ one('e') }}<br>
                {{ one('s') }}
            </div>
        </div>

        <div id="fighting" class="panel panel-default">
            <div class="panel-heading">战斗区</div>
            <div class="panel-body">
                <div id="toolbar">
                    <a data-color="s" class="btn btn-default disabled s"
                        href="#!">&spades;</a>
                    <a data-color="h" class="btn btn-default disabled h"
                        href="#!">&hearts;</a>
                    <a data-color="c" class="btn btn-default disabled c"
                        href="#!">&clubs;</a>
                    <a data-color="d" class="btn btn-default disabled d"
                        href="#!">&diams;</a>
                    <a data-color="O" class="btn btn-default disabled O"
                        href="#!">NT</a>
                </div>
                <div id="pos-n">
                    <span class="avatar"></span>
                </div>
                <div class="clearfix"></div>
                <div id="pos-w">
                    <span class="avatar"></span>
                </div>
                <div id="pos-e">
                    <span class="avatar"></span>
                </div>
                <div class="clearfix"></div>
                <div id="mycards">
                    <span class="O"></span>  {# 主 #}
                    <span class="s"></span>  {# 黑 #}
                    <span class="h"></span>  {# 红 #}
                    <span class="c"></span>  {# 梅 #}
                    <span class="d"></span>  {# 方 #}
                </div>
            </div>
            <div class="panel-footer">
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <form id="form-chat" method="post">
            <div class="hide tpl">
                <li>
                    <div class="media">
                        <a class="pull-left">nickname</a>
                        <div class="media-body">message</div>
                    </div>
                </li>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="input-group">
                        <input type="text" class="form-control" name="msg">
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-default">
                                发送
                            </button>
                        </span>
                    </div>
                </div>
            </div>
            <ul class="chatbox"></ul>
        </form>
    </div>
</div>
@endblock
